# AI助手对话记录

## 对话信息
- **日期**: 2026年02月10日 18时26分46秒
- **主题**: 映射结果校验规则分析
- **关键字**: 需求分析

## 对话内容

**Q: 需求分析：我在设计映射结果时，会输出一个映射关系表，会存储是源系统科目和当前系统科目的映射关系，这张表后续会用于导账处理；但是在实际业务中，我需要对这个映射关系表进行一定的规则校验，让它符合会计上的一些基础逻辑，例如我需要检查：映射关系是否不符合业务逻辑，比如资产类科目映射到负债类科目；某个科目余额为借方的科目映射到了科目余额为贷方的科目。请再此基础上帮我梳理一下还有哪些检查项目，并帮我举例说明。不用写代码给我一个分析文档，我先看**

**A:**

我基于你现有的科目数据和中间表设计，帮你系统梳理了一份《映射结果校验规则分析》，重点从以下几个维度设计校验：

1. **会计要素一致性**：避免资产映射到负债、收入映射到费用等明显违背会计常识的映射。
2. **余额方向合理性**：避免长期借方余额科目映射到典型贷方余额科目，反之亦然。
3. **报表归属一致性**：保证资产负债表项目仍然映射到资产负债表，利润表项目仍然映射到利润表。
4. **辅助核算维度**：保证应按客户/供应商/存货等维度管理的科目，在映射后不会丢失关键维度。
5. **层级与结构合理性**：检查父子科目的映射是否自洽，避免同一父科目下的子科目被映射到性质完全不同的目标。
6. **一对多/多对一映射**：检查合并或拆分映射的合理性（类别、方向、比例等）。
7. **完整性与唯一性**：检查是否有未映射科目、重复映射、目标科目被“滥用”等问题。

同时，我按每个规则给出了：
- 规则编号（R1~R16）
- 校验逻辑
- 业务目的
- 典型示例（包括你提到的“资产→负债”、“借方→贷方”这种场景）
- 严重性分级（错误/告警/提示）

详细内容见文档：`02-需求分析/业务分析/映射结果校验规则分析.md`。

## 关键信息提取

- 映射关系表不仅要“能对上号”，还要通过一系列会计逻辑校验，确保导账结果在会计上是合理的。
- 校验分为：会计类别、余额方向、报表归属、辅助核算、层级结构、一对多/多对一、完整性/唯一性等维度。
- 每条规则都给出了具体示例，方便你后续在设计产品规则或开发校验程序时使用。

## 后续建议

- 你可以先通读《映射结果校验规则分析》，看是否需要根据你公司实际业务再增减规则。
- 确认规则后，我们可以再一起把这些规则转成可执行的校验逻辑（代码或配置）。

