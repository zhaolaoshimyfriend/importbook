# 科目映射对比表使用说明

## 文件说明

**文件名**：`科目映射对比表.xlsx`

**用途**：供用户查看和修改科目映射结果，确认后用于后续导账处理流程

## 表格结构

### 一、源系统科目信息（A-H列，不可修改）

| 列 | 字段名 | 说明 |
|----|--------|------|
| A | 源系统科目编码 | 源系统的科目编码 |
| B | 源系统科目名称 | 源系统的科目名称 |
| C | 源系统父科目编码 | 源系统的父科目编码（如有） |
| D | 源系统父科目名称 | 源系统的父科目名称（如有） |
| E | 源系统科目层级 | 科目层级（1级、2级等） |
| F | 源系统科目类型 | 科目类型（资产/负债/权益/收入/费用） |
| G | 源系统余额方向 | 余额方向（借/贷） |
| H | 源系统辅助核算 | 辅助核算信息（如有） |

### 二、目标系统科目信息（I-P列，参考用）

| 列 | 字段名 | 说明 |
|----|--------|------|
| I | 目标系统科目编码 | 程序匹配的目标科目编码 |
| J | 目标系统科目名称 | 程序匹配的目标科目名称 |
| K | 目标系统父科目编码 | 目标系统的父科目编码 |
| L | 目标系统父科目名称 | 目标系统的父科目名称 |
| M | 目标系统科目层级 | 目标科目层级 |
| N | 目标系统科目类型 | 目标科目类型 |
| O | 目标系统余额方向 | 目标科目余额方向 |
| P | 目标系统辅助核算 | 目标科目辅助核算 |

### 三、匹配过程信息（Q-U列，不可修改）

| 列 | 字段名 | 说明 |
|----|--------|------|
| Q | 匹配类型 | 完全匹配/编码匹配/语义匹配/手动映射等 |
| R | 匹配方法 | 直接匹配/大模型语义匹配/规则匹配等 |
| S | 匹配度评分 | 0-100分，分数越高匹配度越高 |
| T | 匹配置信度 | 高/中/低 |
| U | 匹配依据 | 为什么这样匹配的说明 |

### 四、处理状态信息（V-Z列，不可修改）

| 列 | 字段名 | 说明 |
|----|--------|------|
| V | 映射状态 | 待处理/已匹配/已确认/已拒绝等 |
| W | 是否已确认 | 是/否 |
| X | 是否已修改 | 是/否 |
| Y | 验证结果 | 通过/失败/警告 |
| Z | 是否存在冲突 | 是/否 |

### 五、用户操作区域（AA-AD列，可修改，灰色高亮）

| 列 | 字段名 | 说明 | 操作 |
|----|--------|------|------|
| AA | 用户修改目标编码 | 用户修改后的目标科目编码 | **可填写** |
| AB | 用户修改目标名称 | 用户修改后的目标科目名称 | **可填写** |
| AC | 用户备注 | 用户添加的备注说明 | **可填写** |
| AD | 用户操作 | 用户的操作选择 | **下拉选择**：确认/拒绝/待处理/跳过 |

## 使用流程

### 步骤1：打开Excel文件
- 系统自动匹配后，会生成此Excel文件
- 用户下载并打开文件

### 步骤2：查看映射结果
1. **对比源系统和目标系统**：查看A-H列（源系统）和I-P列（目标系统）
2. **查看匹配依据**：查看U列（匹配依据），了解为什么这样匹配
3. **查看匹配质量**：查看S列（匹配度评分）和T列（匹配置信度）
   - 高置信度（绿色）：可快速确认
   - 中置信度（黄色）：需要仔细审核
   - 低置信度（红色）：需要人工确认

### 步骤3：修改映射结果（如需要）
1. **修改目标科目**：
   - 在AA列填写修改后的目标科目编码
   - 在AB列填写修改后的目标科目名称
2. **添加备注**：
   - 在AC列填写备注说明（如：为什么修改、特殊处理等）
3. **选择操作**：
   - 在AD列下拉选择：确认/拒绝/待处理/跳过

### 步骤4：保存并上传
1. 保存Excel文件
2. 上传回系统
3. 系统读取用户修改，更新映射关系

## 操作示例

### 示例1：确认自动匹配结果
- 源系统：1001-库存现金
- 目标系统：1001-库存现金
- 匹配类型：完全匹配
- 匹配置信度：高
- **操作**：在AD列选择"确认"

### 示例2：修改映射结果
- 源系统：1501.01-债券投资
- 目标系统：150101-债券投资（程序匹配）
- 匹配类型：语义匹配（大模型）
- 匹配置信度：中
- **用户修改**：
  - AA列：150101（保持不变）
  - AB列：债券投资（保持不变）
  - AC列：匹配正确，确认
  - AD列：确认

### 示例3：拒绝映射结果
- 源系统：XXX-特殊科目
- 目标系统：未匹配
- 匹配类型：未匹配
- **用户操作**：
  - AA列：留空
  - AB列：留空
  - AC列：此科目在本系统中不存在，需要创建新科目
  - AD列：拒绝

## 注意事项

1. **只修改灰色高亮区域**（AA-AD列），其他列不可修改
2. **修改后需要验证**：系统会验证修改的合理性
3. **确认后不可撤销**：确认后的映射关系将用于后续导账处理
4. **建议处理顺序**：
   - 先处理高置信度的匹配（快速确认）
   - 再处理中置信度的匹配（仔细审核）
   - 最后处理低置信度和未匹配的（需要人工判断）
5. **数据验证规则**：
   - 目标科目编码必须在系统中存在
   - 科目类型必须一致
   - 余额方向建议一致

## 常见问题

### Q1：如何知道哪些记录需要处理？
A：查看V列（映射状态）和T列（匹配置信度）：
- 状态为"待确认"且置信度为"中"或"低"的记录需要仔细审核
- 状态为"未匹配"的记录需要人工处理

### Q2：修改目标科目编码后，名称需要修改吗？
A：建议同时修改，确保编码和名称对应。如果只修改编码，系统会根据编码自动填充名称。

### Q3：可以批量操作吗？
A：可以，在AD列选择相同的操作类型，系统支持批量处理。

### Q4：修改后如何验证？
A：保存Excel并上传后，系统会自动验证：
- 目标科目是否存在
- 科目类型是否一致
- 余额方向是否合理
- 验证结果会显示在Y列

## 技术支持

如有问题，请联系技术支持或查看系统帮助文档。
